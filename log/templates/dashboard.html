{% extends "index.html" %}

{% block header %} 
<style>
    .dashboard-container {
    width: 100%;
    margin: 0 auto;
    padding: 20px;
}

.navbar {
    background-color: #2c3e50;
    padding: 10px 0;
}

.navbar ul {
    list-style: none;
    display: flex;
    justify-content: center; /* c√¢n gi·ªØa */
    margin: 0;
    padding: 0;
}

.navbar li {
    margin: 0 20px;
}

.navbar a {
    text-decoration: none;
    color: #ecf0f1;
    font-weight: bold;
    padding: 8px 16px;
    border-radius: 4px;
    transition: background 0.3s;
}

.navbar a:hover {
    background-color: #3498db;
    color: #fff;
}

.dashboard-content {
    text-align: center;
    margin-top: 40px;
}

/* --- Ph·∫ßn ti√™u ƒë·ªÅ chung --- */
.section-title {
  text-align: center;
  margin: 40px 0 20px;
  font-size: 1.8em;
  font-weight: bold;
  color: #2c3e50;
  border-bottom: 3px solid #3498db;
  display: inline-block;
  padding-bottom: 5px;
}

/* --- B·∫£ng th·ªã tr∆∞·ªùng & ƒë·∫ßu t∆∞ --- */
.market-table {
  width: 80%;
  margin: 20px auto;
  border-collapse: collapse;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  background: #fff;
}

.market-table th, .market-table td {
  padding: 12px 15px;
  border: 1px solid #ddd;
}

.market-table th {
  background-color: #2c3e50;
  color: #fff;
  text-transform: uppercase;
}

.market-table tr:nth-child(even) {
  background-color: #f9f9f9;
}

.market-table tr:hover {
  background-color: #f1f1f1;
}

/* --- Tin t·ª©c n·ªïi b·∫≠t --- */
.news-list {
  width: 80%;
  margin: 20px auto;
  padding: 0;
  list-style: none;
}

.news-list li {
  background: #fff;
  margin-bottom: 15px;
  padding: 15px;
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  transition: transform 0.2s;
}

.news-list li:hover {
  transform: translateY(-3px);
}

.news-list a {
  font-weight: bold;
  color: #2c3e50;
  text-decoration: none;
}

.news-list a:hover {
  color: #3498db;
}

.news-list small {
  display: block;
  margin-top: 5px;
  color: #7f8c8d;
  font-size: 0.85em;
}

/* --- Bi·ªÉu ƒë·ªì bi·∫øn ƒë·ªông --- */
.chart-container {
  width: 80%;
  margin: 40px auto;
  padding: 20px;
  background: #fff;
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

</style> 
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Thanh menu tr√™n c√πng -->
    <nav class="navbar">
        <ul>
            <li><a href="{% url 'category_list' %}">Danh m·ª•c</a></li>
            <li><a href="{% url 'transactions' %}?filter=false&pn=1">Giao d·ªãch</a></li>
            <li><a href="{% url 'export_csv_filter' %}">Xu·∫•t CSV</a></li>
            <li><a href="{% url 'summary' %}">T·ªïng k·∫øt</a></li>
            <li><a href="{% url 'sign_out' %}">ƒêƒÉng xu·∫•t</a></li>
        </ul>
    </nav>

    <!-- N·ªôi dung ch√≠nh -->
    <section class="dashboard-content">
        <h1>B·∫£ng ƒêi·ªÅu Khi·ªÉn</h1>
    </section>

  <h2 class="section-title">üåç Th·ªã tr∆∞·ªùng & ƒê·∫ßu t∆∞</h2>

  <!-- 1Ô∏è‚É£ B·∫£ng ch·ªâ s·ªë -->
  <table border="1" class="market-table">
    <tr><th class = "market-table th" >Ch·ªâ s·ªë</th><th class = "market-table th" >Gi√° hi·ªán t·∫°i</th><th class = "market-table th">Thay ƒë·ªïi (%)</th></tr>
    {% for name, info in market_data.items %}
    <tr>
      <td class = "market-table td">{{ name }}</td>
      <td class = "market-table td">{{ info.price | default:"N/A" }}</td>
      <td class = "market-table td" style="color: {{ info.change|floatformat:2|yesno:'green,red' }}">
        {{ info.change | default:"N/A" }}%
      </td>
    </tr>
    {% endfor %}
  </table>

  <!-- 2Ô∏è‚É£ Tin t·ª©c ƒë·∫ßu t∆∞ -->
  <h3 style="margin-top:30px;">üì∞ Tin t·ª©c n·ªïi b·∫≠t</h3>
  <ul class="news-list">
    {% if news_list %}
        {% for n in news_list %}
            <li class="news-list li">
                <a class="news-list a" href="{{ n.url }}" target="_blank">{{ n.title }}</a>
                <small>({{ n.source }})</small>
            </li>
        {% endfor %}
    {% else %}
        <p>Ch∆∞a c√≥ tin t·ª©c m·ªõi</p>
    {% endif %}
</ul>


  <!-- 3Ô∏è‚É£ Bi·ªÉu ƒë·ªì bi·∫øn ƒë·ªông -->
  <h3 style="margin-top:40px;">üíπ Bi·∫øn ƒë·ªông th·ªã tr∆∞·ªùng</h3>
  <div class="chart-container">
    <canvas id="marketChart" width="400" height="200"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
    const ctx = document.getElementById('marketChart');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: [{% for n in market_data.keys %}'{{ n }}',{% endfor %}],
        datasets: [{
          label: 'M·ª©c thay ƒë·ªïi (%)',
          data: [{% for n in market_data.values %}{{ n.change|default:0 }},{% endfor %}],
          backgroundColor: ['green','red','blue','orange','gray']
        }]
      }
    });
    </script>
  </div>
</div>
{% endblock %}

